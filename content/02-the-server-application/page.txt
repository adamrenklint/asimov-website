title: The server application
---
text:

At the heart of asimov.js is a simple express server with some smart middleware hooked into it. By adding your own custom initializers and request middleware, you can extend the server modify the entire flow of rendering and caching.

## Bootstrap

Once you start the server application using <code>node main.js</code>, there's a bunch of things that happens. In <code>main.js</code> you have the chance to pass in options to the bootstrap, and change the behavior of some or all components.

After playing a pretty intro animation, the crawler scans <code>options.paths.content</code> for all <code>.txt</code> files and create a map of the available urls. This map is passed to the render queueu, and to the server to be used by the cache router, and the web server is started and can start handling requests.

Templates and template helpers are then loaded and validated, and the render queue starts processing jobs, saving its output to the cache. As application bundles and stylesheets are included in the rendered pages, they are also added to the render queue. 

Finally, the file structure is observed for changes, which triggers re-rendering of the changed resource, and all other resources that depends on it.

## The flow of a request

When the server receives a request, it first passes through a set of server middleware, then any middleware you have added, then some more framework middleware, and if the request has not been taken care of by then, a 404 is returned.

When a request for a url that should be cached is received, it's passed on to the cache instance that tries to find the resource. If it or any of its dependencies are in queue to be rendered, they get pushed to the front of the queue and the requests are served as soon as rendering is complete. 

When the <code>ENV</code> flag is set to <code>dev</code>, **pages are always re-rendered** before they are sent to the browser - but application bundles and stylesheets are still only recompiled when changed.

## Logging

Logging happens on three levels: verbose, default and silent. Set <code>options.logVerbose</code> to <code>true</code> in <code>main.js</code> to see everything. Set <code>options.logSilent</code> to <code>true</code> to mute all logging except for critical system messages, and of course errors.

## Disable intro animation

In case you want to shave of a second or two from the startup time, you can disable the intro animation by setting <code>options.animateIntro</code> to <code>false</code> in <code>main.js</code>.